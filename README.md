# 二维伊辛格模型蒙特卡洛模拟

这个项目实现了二维伊辛格模型的蒙特卡洛模拟，研究了不同温度和系统大小下的物理特性。项目包含标准实现和Numba加速版本，以获得更高的计算性能。

## 项目背景

伊辛格模型是统计物理学中描述铁磁性的经典模型。在该模型中，每个格点上的自旋可以取+1或-1两个值，相邻自旋之间存在相互作用。本项目模拟的能量哈密顿量为：

```
E = -J * sum(s_i * s_j) - μH * sum(s_i)
```

其中，J是耦合常数（默认取J=1），H是外部磁场（默认取H=0）。

## 功能特性

- 使用Metropolis算法进行蒙特卡洛模拟
- 支持不同尺寸的二维格子（默认L=10, 20, 30）
- 模拟温度范围从T=0.015到T=4.5（可定制）
- 多进程并行计算，提高模拟效率
- Numba加速版本（main_numba.py），显著提升计算速度
- 计算平均能量、比热容、磁化强度和磁化率
- 生成各物理量随温度变化的图表
- 有限尺寸标度分析临界温度与系统大小的关系
- 能量和磁化强度导数计算

## 技术实现

- **ising_model.py/ising_model_numba.py**: 实现伊辛格模型的核心算法，包括能量计算、磁化强度计算和Metropolis步骤
- **simulation.py/simulation_numba.py**: 实现单温度和温度扫描的模拟过程，支持多进程并行计算
- **analysis.py**: 实现物理量的计算和有限尺寸标度分析
- **plotting.py**: 负责结果可视化，生成各种物理量与温度的关系图
- **energy_derivative_analysis.py**: 计算能量和磁化强度导数
- **main.py/main_numba.py**: 主程序入口，包含命令行参数解析

## 安装依赖

```bash
pip install -r requirements.txt
```

主要依赖包括：
- numpy==2.1.3
- matplotlib==3.10.1
- tqdm==4.67.1
- scipy==1.15.2
- pandas==2.2.3
- numba==0.61.0

## 使用方法

运行标准版本：

```bash
python main.py
```

运行Numba加速版本：

```bash
python main_numba.py
```

### 命令行参数

程序支持多种命令行参数来定制模拟：

```
--L [L1 L2 ...]: 系统大小列表 (默认: 10 20 30)
--T-min: 最小温度 (默认: 0.015)
--T-max: 最大温度 (默认: 4.5)
--T-step: 温度步长 (默认: 0.015)
--therm-steps: 热化步数 (默认: 10^5)
--measure-steps: 测量步数 (默认: 3*10^5)
--measure-interval: 测量间隔 (默认: 10)
--processes: 并行进程数 (默认: 根据CPU限制自动设置)
--cpu-limit: CPU使用率上限百分比 (默认: 80%)
--load: 加载之前的结果文件 (默认: 不加载)
--no-plots: 不生成图表
--save-prefix: 结果文件名前缀 (默认: "")
```

## 物理量计算

- **平均能量**: E = ⟨E⟩/N
- **比热容**: C = (1/NkT²)⟨(δE)²⟩
- **磁化强度**: M = ⟨|∑ᵢsᵢ|⟩/N
- **磁化率**: χ = (1/NkT)⟨(δM)²⟩

## 结果分析

项目输出包括：
1. 能量与温度的关系图
2. 磁化强度与温度的关系图
3. 磁化率与温度的关系图
4. 比热容与温度的关系图
5. 临界温度与系统大小的关系图（有限尺寸标度）
6. 能量导数分析图

所有结果保存在`output`目录下，包括数据文件和图表。

## 性能优化

- 使用Numba JIT编译加速计算密集型操作
- 多进程并行计算不同温度点的模拟
- 自动调整进程数以控制CPU使用率
- 优化的蒙特卡洛采样算法

